{"version":3,"file":"shopee-link/index.js","mappings":"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","sources":["webpack://rb-gutenberg-blocks/./src/shopee-link/edit.js","webpack://rb-gutenberg-blocks/external window \"React\"","webpack://rb-gutenberg-blocks/external window [\"wp\",\"blockEditor\"]","webpack://rb-gutenberg-blocks/external window [\"wp\",\"blocks\"]","webpack://rb-gutenberg-blocks/external window [\"wp\",\"components\"]","webpack://rb-gutenberg-blocks/external window [\"wp\",\"data\"]","webpack://rb-gutenberg-blocks/external window [\"wp\",\"element\"]","webpack://rb-gutenberg-blocks/webpack/bootstrap","webpack://rb-gutenberg-blocks/webpack/runtime/compat get default export","webpack://rb-gutenberg-blocks/webpack/runtime/define property getters","webpack://rb-gutenberg-blocks/webpack/runtime/hasOwnProperty shorthand","webpack://rb-gutenberg-blocks/webpack/runtime/make namespace object","webpack://rb-gutenberg-blocks/./src/shopee-link/index.js"],"sourcesContent":["import {\n\tPanelBody,\n} from '@wordpress/components';\nimport { \n\twithSelect,\n\tuseDispatch \n} from '@wordpress/data';\n\nimport { \n\tInnerBlocks, \n\tInspectorControls,\n\tuseBlockProps,\n\tuseInnerBlocksProps,\n\tstore\n} from '@wordpress/block-editor';\nimport { createBlocksFromInnerBlocksTemplate } from '@wordpress/blocks';\n \nimport { \n\t__experimentalInputControl as InputControl,\n\t__experimentalVStack as VStack,\n\t__experimentalHStack as HStack,\n\t__experimentalText as Text,\n} from '@wordpress/components';\nimport { useCallback, useEffect, useMemo, useState } from '@wordpress/element';\n\nimport defaultTemplate from './template.json';\n\nexport const getTemplate = ({ image = '', link = '', message = ''}) => {\n\tlet templateString = JSON.stringify(defaultTemplate);\n\ttemplateString = templateString\n\t\t.replaceAll('{{link}}', link)\n\t\t.replaceAll('{{message}}', message)\n\t\t.replaceAll('{{image}}', image);\n\n\treturn JSON.parse(templateString);\n}\n\nconst Edit = ({ image, message, clientId, attributes, setAttributes}) => {\n\tconst { replaceInnerBlocks } = useDispatch( store );\n\tconst blockProps = useBlockProps();\n\tconst innerBlocksProps = useInnerBlocksProps(blockProps)\n\n\tconst updateBlockAttrs = ({ url }) => {\n\t\tlet link = '';\n\t\tvar isValid = url.match(/(http(s)?:\\/\\/.)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)/g);\n\t\tif ( !!url && isValid !== null ) {\n\t\t\tlink = url;\n\t\t}\n\t\tsetAttributes({ url: link });\n\t}\n\tconst changeHandle = (newValue = '') => {\n\t\tif ( !!window.updateBlockTimeout ) clearTimeout(window.updateBlockTimeout)\n\t\twindow.updateBlockTimeout = setTimeout(() => {\n\t\t\tupdateBlockAttrs({ url: newValue });\n\t\t\twindow.updateBlockTimeout = false;\n\t\t}, 600);\n\t}\n\t\n\tconst template = useMemo(() => {\n\t\tsetAttributes({\n\t\t\timage,\n\t\t\tmessage\n\t\t})\n\t\treturn getTemplate({\n\t\t\timage: image || attributes.image || 'http://placehold.it/80x100?text=img',\n\t\t\tlink: attributes.url,\n\t\t\tmessage: message || attributes.message || 'Your message go here'\n\t\t})\n\t}, [image, message, attributes.url, setAttributes]);\n\t\n\tuseEffect(() => {\n\t\twindow.timeoutRenderBlocks = setTimeout(() => {\n\t\t\treplaceInnerBlocks(clientId, createBlocksFromInnerBlocksTemplate(template));\n\t\t\twindow.timeoutRenderBlocks = false;\n\t\t}, 1000)\n\t\treturn () => !!window.timeoutRenderBlocks && clearTimeout(window.timeoutRenderBlocks );\n\t}, [clientId, template])\n\n\treturn (\n\t\t<>\n\t\t\t\t<InspectorControls>\n\t\t\t\t\t<PanelBody title={ 'Settings' }>\n\t\t\t\t\t\t<InputControl\n\t\t\t\t\t\t\tlabel={\"Product Link\"}\n\t\t\t\t\t\t\tvalue={attributes.url}\n\t\t\t\t\t\t\tonChange={changeHandle}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\n\t\t\t\t</InspectorControls>\n\t\t\t\t{!!attributes.url && \n\t\t\t\t\t<div {...blockProps}>\n\t\t\t\t\t\t<div {...innerBlocksProps} />\n\t\t\t\t\t</div>\t\n\t\t\t\t}\n\t\t</>\n\t)\n}\n\nexport default withSelect( ( select, blockData ) => {\n\tconst blocks = select( 'core/block-editor' ).getBlocks( blockData.clientId );\n\tlet image = '';\n\tlet message = '';\n\tconst getBlockValue = (block, name, field) => {\n\t\tlet value = false;\n\t\tblock.innerBlocks.forEach(child => {\n\t\t\tif ( value ) return; // Skip\n\t\t\tif ( child.name === name ) {\n\t\t\t\tvalue = child.attributes[field];\n\t\t\t} else if ( !!child.innerBlocks && child.innerBlocks.length > 0 ) {\n\t\t\t\tvalue = getBlockValue(child, name, field)\n\t\t\t}\n\t\t})\n\t\treturn value;\n\t}\n\tif ( blocks.length > 0 ) {\n\t\t// Just get innerBlock data\n\t\timage = getBlockValue(blocks[0], 'core/image', 'url');\n\t\tmessage = getBlockValue(blocks[0], 'core/navigation-link', 'label')\n\t}\n\treturn {\n\t\timage,\n\t\tmessage\n\t};\n} )(Edit);","module.exports = window[\"React\"];","module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"blocks\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { registerBlockType } from '@wordpress/blocks';\nimport metadata from './block.json';\nimport Edit from './edit';\n// Register the block\nregisterBlockType(metadata, {\n\tedit: Edit,\n\tsave: () => null // Nil becuz this is dynamic block\n});"],"names":["PanelBody","withSelect","useDispatch","InnerBlocks","InspectorControls","useBlockProps","useInnerBlocksProps","store","createBlocksFromInnerBlocksTemplate","__experimentalInputControl","InputControl","__experimentalVStack","VStack","__experimentalHStack","HStack","__experimentalText","Text","useCallback","useEffect","useMemo","useState","defaultTemplate","getTemplate","image","link","message","templateString","JSON","stringify","replaceAll","parse","Edit","clientId","attributes","setAttributes","replaceInnerBlocks","blockProps","innerBlocksProps","updateBlockAttrs","url","isValid","match","changeHandle","newValue","window","updateBlockTimeout","clearTimeout","setTimeout","template","timeoutRenderBlocks","createElement","Fragment","title","label","value","onChange","select","blockData","blocks","getBlocks","getBlockValue","block","name","field","innerBlocks","forEach","child","length","registerBlockType","metadata","edit","save"],"sourceRoot":""}