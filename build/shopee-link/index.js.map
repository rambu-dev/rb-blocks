{"version":3,"file":"shopee-link/index.js","mappings":"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","sources":["webpack://rb-gutenberg-blocks/./src/shopee-link/edit.js","webpack://rb-gutenberg-blocks/external window \"React\"","webpack://rb-gutenberg-blocks/external window [\"wp\",\"blockEditor\"]","webpack://rb-gutenberg-blocks/external window [\"wp\",\"blocks\"]","webpack://rb-gutenberg-blocks/external window [\"wp\",\"components\"]","webpack://rb-gutenberg-blocks/external window [\"wp\",\"data\"]","webpack://rb-gutenberg-blocks/external window [\"wp\",\"element\"]","webpack://rb-gutenberg-blocks/webpack/bootstrap","webpack://rb-gutenberg-blocks/webpack/runtime/compat get default export","webpack://rb-gutenberg-blocks/webpack/runtime/define property getters","webpack://rb-gutenberg-blocks/webpack/runtime/hasOwnProperty shorthand","webpack://rb-gutenberg-blocks/webpack/runtime/make namespace object","webpack://rb-gutenberg-blocks/./src/shopee-link/index.js"],"sourcesContent":["import {\n\tPanelBody,\n} from '@wordpress/components';\nimport { \n\twithSelect,\n\tuseDispatch \n} from '@wordpress/data';\n\nimport { \n\tInnerBlocks, \n\tInspectorControls,\n\tuseBlockProps,\n\tuseInnerBlocksProps,\n\tstore\n} from '@wordpress/block-editor';\nimport { createBlocksFromInnerBlocksTemplate } from '@wordpress/blocks';\n \nimport { \n\t__experimentalInputControl as InputControl,\n\t__experimentalVStack as VStack,\n\t__experimentalHStack as HStack,\n\t__experimentalText as Text,\n} from '@wordpress/components';\nimport { useEffect, useMemo, useState } from '@wordpress/element';\n\nimport defaultTemplate from './template.json';\n\nexport const getTemplate = ({ image = '', link = '', message = ''}) => {\n\tlet templateString = JSON.stringify(defaultTemplate);\n\ttemplateString = templateString\n\t\t.replaceAll('{{link}}', link)\n\t\t.replaceAll('{{message}}', message)\n\t\t.replaceAll('{{image}}', image);\n\n\treturn JSON.parse(templateString);\n}\n\nconst Edit = ({ image, clientId, attributes, setAttributes}) => {\n\tconst { replaceInnerBlocks } = useDispatch( store );\n\tconst blockProps = useBlockProps();\n\tconst innerBlocksProps = useInnerBlocksProps(blockProps)\n\n\tconst updateBlockAttrs = ({ url }) => {\n\t\tlet link = '';\n\t\tvar isValid = url.match(/(http(s)?:\\/\\/.)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)/g);\n\t\tif ( !!url && isValid !== null ) {\n\t\t\tlink = url;\n\t\t}\n\t\tsetAttributes({ url: link });\n\t}\n\tconst changeHandle = (newValue = '') => {\n\t\tif ( !!window.updateBlockTimeout ) clearTimeout(window.updateBlockTimeout)\n\t\twindow.updateBlockTimeout = setTimeout(() => {\n\t\t\tupdateBlockAttrs({ url: newValue });\n\t\t\twindow.updateBlockTimeout = false;\n\t\t}, 600);\n\t}\n\n\tconst product_image = useMemo(() => image || attributes.image || 'http://placehold.it/80x100?text=img', [image, attributes.image])\n\n\tuseEffect(() => {\n\t\tsetAttributes({ image: image });\n\t\tconst template = getTemplate({\n\t\t\timage: product_image,\n\t\t\tlink: attributes.url,\n\t\t\tmessage: attributes.message || 'Your message go here'\n\t\t});\n\t\treplaceInnerBlocks(clientId, createBlocksFromInnerBlocksTemplate(template));\n\t}, [attributes.url, setAttributes, product_image])\n\n\treturn (\n\t\t<>\n\t\t\t\t<InspectorControls>\n\t\t\t\t\t<PanelBody title={ 'Settings' }>\n\t\t\t\t\t\t<InputControl\n\t\t\t\t\t\t\tlabel={\"Product Link\"}\n\t\t\t\t\t\t\tvalue={attributes.url}\n\t\t\t\t\t\t\tonChange={changeHandle}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\n\t\t\t\t</InspectorControls>\n\t\t\t\t{!!attributes.url && \n\t\t\t\t\t<div {...blockProps}>\n\t\t\t\t\t\t<div {...innerBlocksProps} />\n\t\t\t\t\t</div>\t\n\t\t\t\t}\n\t\t</>\n\t)\n}\n\nexport default withSelect( ( select, blockData ) => {\n\tconst blocks = select( 'core/block-editor' ).getBlocks( blockData.clientId );\n\tlet image = '';\n\tif ( blocks.length > 0 ) {\n\t\t// Just get innerBlock data\n\t\tblocks[0].innerBlocks.forEach(block => {\n\t\t\tif ( block.name === 'core/image') {\n\t\t\t\timage = block.attributes.url\n\t\t\t}\n\t\t})\n\t}\n\treturn {\n\t\timage: image\n\t};\n} )(Edit);","module.exports = window[\"React\"];","module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"blocks\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { registerBlockType } from '@wordpress/blocks';\nimport metadata from './block.json';\nimport Edit from './edit';\n// Register the block\nregisterBlockType(metadata, {\n\tedit: Edit,\n\tsave: () => null // Nil becuz this is dynamic block\n});"],"names":["PanelBody","withSelect","useDispatch","InnerBlocks","InspectorControls","useBlockProps","useInnerBlocksProps","store","createBlocksFromInnerBlocksTemplate","__experimentalInputControl","InputControl","__experimentalVStack","VStack","__experimentalHStack","HStack","__experimentalText","Text","useEffect","useMemo","useState","defaultTemplate","getTemplate","image","link","message","templateString","JSON","stringify","replaceAll","parse","Edit","clientId","attributes","setAttributes","replaceInnerBlocks","blockProps","innerBlocksProps","updateBlockAttrs","url","isValid","match","changeHandle","newValue","window","updateBlockTimeout","clearTimeout","setTimeout","product_image","template","createElement","Fragment","title","label","value","onChange","select","blockData","blocks","getBlocks","length","innerBlocks","forEach","block","name","registerBlockType","metadata","edit","save"],"sourceRoot":""}